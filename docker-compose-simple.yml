     services:
       mysql-rbac:
         image: mysql:8.0
         container_name: artyco-mysql-rbac
         environment:
           MYSQL_ROOT_PASSWORD: rootpassword123
           MYSQL_DATABASE: artyco_financial_rbac
           MYSQL_USER: artyco_user
           MYSQL_PASSWORD: artyco_password123
         ports:
           - "3307:3306"
         volumes:
           - mysql-rbac-data:/var/lib/mysql
           - ./docker/mysql:/docker-entrypoint-initdb.d
         command: --default-authentication-plugin=mysql_native_password

       api-rbac:
         image: python:3.12-slim
         container_name: artyco-api-rbac
         working_dir: /app
         environment:
           - DATABASE_URL=mysql+pymysql://artyco_user:artyco_password123@mysql-rbac:3306/artyco_financial_rbac
           - JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production
           - CORS_ORIGINS=http://localhost:3001,http://localhost:8001
           - PYTHONUNBUFFERED=1
         ports:
           - "8001:8000"
         volumes:
           - .:/app
         depends_on:
           - mysql-rbac
         restart: unless-stopped
         command: >
           bash -c "
             echo 'ğŸ”§ Installing dependencies...' &&
             apt-get update &&
             apt-get install -y gcc default-libmysqlclient-dev pkg-config curl &&
             pip install --no-cache-dir fastapi uvicorn PyJWT passlib[bcrypt] python-multipart sqlalchemy pymysql alembic python-dotenv &&
             echo 'â³ Waiting for database...' &&
             sleep 15 &&
             echo 'ğŸš€ Starting API server...' &&
             python api_simple.py
           "

     volumes:
       mysql-rbac-data: